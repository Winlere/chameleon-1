---
pages:
  image: hpclib/hiepacs
  stage: deploy
  dependencies: []
  artifacts:
    name: chameleon_doc
    expire_in: 1 week
    paths:
      - public
  variables:
    VERSION: pages
  script:
    - cd build-$VERSION
    - cmake .. -DCHAMELEON_ENABLE_DOC=ON
    - make doc -j5
    - mv doc/orgmode/ ../public/
    - ln -s ../public/users_guide.html ../public/index.html
    - mv doc/doxygen/out/html/ ../public/doxygen/
  only:
    - master@solverstack/chameleon
    - /^ci-.*$/
  except:
    - schedules
